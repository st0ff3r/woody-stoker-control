gpasm-0.13.7 beta               glcd.asm    12-18-2012  04:56:14         PAGE  1


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE
 
               00001 ;--------------------------------------------------------
               00002 ; File Created by SDCC : free open source ANSI-C Compiler
               00003 ; Version 3.0.0 #6037 (Jul 16 2012) (Mac OS X x86_64)
               00004 ; This file was generated Tue Dec 18 04:56:14 2012
               00005 ;--------------------------------------------------------
               00006 ; PIC16 port for the Microchip 16-bit core micros
               00007 ;--------------------------------------------------------
               00008         list    p=18f4620
               00009 
               00010         radix dec
               00011 
               00012 ;--------------------------------------------------------
               00013 ; public variables in this module
               00014 ;--------------------------------------------------------
               00015         global _lcd_buffer
               00016         global _lcd_init
               00017         global _lcd_enable
               00018         global _lcd_status
               00019         global _lcd_reset
               00020         global _lcd_screenon
               00021         global _lcd_cls
               00022         global _lcd_setpage
               00023         global _lcd_setyaddr
               00024         global _lcd_waitbusy
               00025         global _lcd_write
               00026         global _lcd_selectside
               00027         global _lcd_read
               00028         global _lcd_plot_pixel
               00029 
               00030 ;--------------------------------------------------------
               00031 ; extern variables in this module
               00032 ;--------------------------------------------------------
               00033         extern _PORTAbits
               00034         extern _PORTBbits
               00035         extern _PORTCbits
               00036         extern _PORTDbits
               00037         extern _PORTEbits
               00038         extern _LATAbits
               00039         extern _LATBbits
               00040         extern _LATCbits
               00041         extern _LATDbits
               00042         extern _LATEbits
               00043         extern _TRISAbits
               00044         extern _TRISBbits
               00045         extern _TRISCbits
               00046         extern _TRISDbits
               00047         extern _TRISEbits
               00048         extern _OSCTUNEbits
               00049         extern _PIE1bits
               00050         extern _PIR1bits
               00051         extern _IPR1bits
               00052         extern _PIE2bits
               00053         extern _PIR2bits
               00054         extern _IPR2bits
gpasm-0.13.7 beta               glcd.asm    12-18-2012  04:56:14         PAGE  2


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE
 
               00055         extern _EECON1bits
               00056         extern _RCSTAbits
               00057         extern _TXSTAbits
               00058         extern _T3CONbits
               00059         extern _CMCONbits
               00060         extern _CVRCONbits
               00061         extern _ECCP1ASbits
               00062         extern _PWM1CONbits
               00063         extern _BAUDCONbits
               00064         extern _CCP2CONbits
               00065         extern _CCP1CONbits
               00066         extern _ADCON2bits
               00067         extern _ADCON1bits
               00068         extern _ADCON0bits
               00069         extern _SSPCON2bits
               00070         extern _SSPCON1bits
               00071         extern _SSPSTATbits
               00072         extern _T2CONbits
               00073         extern _T1CONbits
               00074         extern _RCONbits
               00075         extern _WDTCONbits
               00076         extern _HLVDCONbits
               00077         extern _OSCCONbits
               00078         extern _T0CONbits
               00079         extern _STATUSbits
               00080         extern _FSR2Hbits
               00081         extern _BSRbits
               00082         extern _FSR1Hbits
               00083         extern _FSR0Hbits
               00084         extern _INTCON3bits
               00085         extern _INTCON2bits
               00086         extern _INTCONbits
               00087         extern _TBLPTRUbits
               00088         extern _PCLATHbits
               00089         extern _PCLATUbits
               00090         extern _STKPTRbits
               00091         extern _TOSUbits
               00092         extern _PORTA
               00093         extern _PORTB
               00094         extern _PORTC
               00095         extern _PORTD
               00096         extern _PORTE
               00097         extern _LATA
               00098         extern _LATB
               00099         extern _LATC
               00100         extern _LATD
               00101         extern _LATE
               00102         extern _TRISA
               00103         extern _TRISB
               00104         extern _TRISC
               00105         extern _TRISD
               00106         extern _TRISE
               00107         extern _OSCTUNE
               00108         extern _PIE1
gpasm-0.13.7 beta               glcd.asm    12-18-2012  04:56:14         PAGE  3


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE
 
               00109         extern _PIR1
               00110         extern _IPR1
               00111         extern _PIE2
               00112         extern _PIR2
               00113         extern _IPR2
               00114         extern _EECON1
               00115         extern _EECON2
               00116         extern _EEDATA
               00117         extern _EEADR
               00118         extern _EEADRH
               00119         extern _RCSTA
               00120         extern _TXSTA
               00121         extern _TXREG
               00122         extern _RCREG
               00123         extern _SPBRG
               00124         extern _SPBRGH
               00125         extern _T3CON
               00126         extern _TMR3L
               00127         extern _TMR3H
               00128         extern _CMCON
               00129         extern _CVRCON
               00130         extern _ECCP1AS
               00131         extern _PWM1CON
               00132         extern _BAUDCON
               00133         extern _CCP2CON
               00134         extern _CCPR2L
               00135         extern _CCPR2H
               00136         extern _CCP1CON
               00137         extern _CCPR1L
               00138         extern _CCPR1H
               00139         extern _ADCON2
               00140         extern _ADCON1
               00141         extern _ADCON0
               00142         extern _ADRESL
               00143         extern _ADRESH
               00144         extern _SSPCON2
               00145         extern _SSPCON1
               00146         extern _SSPSTAT
               00147         extern _SSPADD
               00148         extern _SSPBUF
               00149         extern _T2CON
               00150         extern _PR2
               00151         extern _TMR2
               00152         extern _T1CON
               00153         extern _TMR1L
               00154         extern _TMR1H
               00155         extern _RCON
               00156         extern _WDTCON
               00157         extern _HLVDCON
               00158         extern _OSCCON
               00159         extern _T0CON
               00160         extern _TMR0L
               00161         extern _TMR0H
               00162         extern _STATUS
gpasm-0.13.7 beta               glcd.asm    12-18-2012  04:56:14         PAGE  4


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE
 
               00163         extern _FSR2L
               00164         extern _FSR2H
               00165         extern _PLUSW2
               00166         extern _PREINC2
               00167         extern _POSTDEC2
               00168         extern _POSTINC2
               00169         extern _INDF2
               00170         extern _BSR
               00171         extern _FSR1L
               00172         extern _FSR1H
               00173         extern _PLUSW1
               00174         extern _PREINC1
               00175         extern _POSTDEC1
               00176         extern _POSTINC1
               00177         extern _INDF1
               00178         extern _WREG
               00179         extern _FSR0L
               00180         extern _FSR0H
               00181         extern _PLUSW0
               00182         extern _PREINC0
               00183         extern _POSTDEC0
               00184         extern _POSTINC0
               00185         extern _INDF0
               00186         extern _INTCON3
               00187         extern _INTCON2
               00188         extern _INTCON
               00189         extern _PRODL
               00190         extern _PRODH
               00191         extern _TABLAT
               00192         extern _TBLPTRL
               00193         extern _TBLPTRH
               00194         extern _TBLPTRU
               00195         extern _PCL
               00196         extern _PCLATH
               00197         extern _PCLATU
               00198         extern _STKPTR
               00199         extern _TOSL
               00200         extern _TOSH
               00201         extern _TOSU
               00202         extern _sleep_ms
               00203 ;--------------------------------------------------------
               00204 ;       Equates to used internal registers
               00205 ;--------------------------------------------------------
  00000FD8     00206 STATUS  equ     0xfd8
  00000FE8     00207 WREG    equ     0xfe8
  00000FE1     00208 FSR1L   equ     0xfe1
  00000FD9     00209 FSR2L   equ     0xfd9
  00000FE5     00210 POSTDEC1        equ     0xfe5
  00000FE4     00211 PREINC1 equ     0xfe4
  00000FDB     00212 PLUSW2  equ     0xfdb
               00213 
               00214 
               00215 ; Internal registers
               00216 .registers      udata_ovr       0x0000
gpasm-0.13.7 beta               glcd.asm    12-18-2012  04:56:14         PAGE  5


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE
 
               00217 r0x00   res     1
               00218 r0x01   res     1
               00219 r0x02   res     1
               00220 
               00221 udata_glcd_0    udata
               00222 _lcd_buffer     res     1
               00223 
               00224 ;--------------------------------------------------------
               00225 ; global & static initialisations
               00226 ;--------------------------------------------------------
               00227 ; I code from now on!
               00228 ; ; Starting pCode block
               00229 S_glcd__lcd_plot_pixel  code
0000 00230 _lcd_plot_pixel:
               00231 ;       .line   202; glcd.c     void lcd_plot_pixel(unsigned char rx, unsigned char ry) {
0000 CFD9 FFE5 00232         MOVFF   FSR2L, POSTDEC1
0004 CFE1 FFD9 00233         MOVFF   FSR1L, FSR2L
0008 C000 FFE5 00234         MOVFF   r0x00, POSTDEC1
000C C000 FFE5 00235         MOVFF   r0x01, POSTDEC1
0010 C000 FFE5 00236         MOVFF   r0x02, POSTDEC1
0014 0E02      00237         MOVLW   0x02
0016 CFDB F000 00238         MOVFF   PLUSW2, r0x00
001A 0E03      00239         MOVLW   0x03
001C CFDB F000 00240         MOVFF   PLUSW2, r0x01
               00241 ;       .line   207; glcd.c     if (rx & 64) {
0020 AC00      00242         BTFSS   r0x00, 6
0022 D000      00243         BRA     _00205_DS_
               00244 ;       .line   208; glcd.c     lcd_selectside(LCD_RIGHT);
0024 0E02      00245         MOVLW   0x02
0026 6EE5      00246         MOVWF   POSTDEC1
0028 EC00 F000 00247         CALL    _lcd_selectside
002C 2AE1      00248         INCF    FSR1L, F
002E D000      00249         BRA     _00206_DS_
0030 00250 _00205_DS_:
               00251 ;       .line   211; glcd.c     lcd_selectside(LCD_LEFT);
0030 0E01      00252         MOVLW   0x01
0032 6EE5      00253         MOVWF   POSTDEC1
0034 EC00 F000 00254         CALL    _lcd_selectside
0038 2AE1      00255         INCF    FSR1L, F
003A 00256 _00206_DS_:
               00257 ;       .line   214; glcd.c     lcd_setpage( ry >> 3);          // fast /8
003A 3800      00258         SWAPF   r0x01, W
003C 44E8      00259         RLNCF   WREG, W
003E 0B1F      00260         ANDLW   0x1f
0040 6E00      00261         MOVWF   r0x02
0042 5000      00262         MOVF    r0x02, W
0044 6EE5      00263         MOVWF   POSTDEC1
0046 EC00 F000 00264         CALL    _lcd_setpage
004A 2AE1      00265         INCF    FSR1L, F
               00266 ;       .line   215; glcd.c     lcd_setyaddr( rx & 0b00111111);
004C 0E3F      00267         MOVLW   0x3f
004E 1600      00268         ANDWF   r0x00, F
0050 5000      00269         MOVF    r0x00, W
0052 6EE5      00270         MOVWF   POSTDEC1
gpasm-0.13.7 beta               glcd.asm    12-18-2012  04:56:14         PAGE  6


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE
 
0054 EC00 F000 00271         CALL    _lcd_setyaddr
0058 2AE1      00272         INCF    FSR1L, F
               00273 ;       .line   216; glcd.c     d = lcd_read();                         // read to move data to GLCD buffer,
005A EC00 F000 00274         CALL    _lcd_read
               00275 ;       .line   217; glcd.c     d = lcd_read();                         // read again to transfer to pic
005E EC00 F000 00276         CALL    _lcd_read
0062 6E00      00277         MOVWF   r0x02
               00278 ;       .line   218; glcd.c     lcd_setyaddr( rx & 0b00111111); 
0064 5000      00279         MOVF    r0x00, W
0066 6EE5      00280         MOVWF   POSTDEC1
0068 EC00 F000 00281         CALL    _lcd_setyaddr
006C 2AE1      00282         INCF    FSR1L, F
               00283 ;       .line   219; glcd.c     lcd_write (d | (1 << (ry & 0b111)));
006E 0E07      00284         MOVLW   0x07
0070 1600      00285         ANDWF   r0x01, F
0072 0E01      00286         MOVLW   0x01
0074 6E00      00287         MOVWF   r0x00
0076 5000      00288         MOVF    r0x01, W
0078 E000      00289         BZ      _00213_DS_
007A 6CE8      00290         NEGF    WREG
007C 90D8      00291         BCF     STATUS, 0
007E 00292 _00214_DS_:
007E 3600      00293         RLCF    r0x00, F
0080 0F01      00294         ADDLW   0x01
0082 E300      00295         BNC     _00214_DS_
0084 00296 _00213_DS_:
0084 5000      00297         MOVF    r0x00, W
0086 1200      00298         IORWF   r0x02, F
0088 5000      00299         MOVF    r0x02, W
008A 6EE5      00300         MOVWF   POSTDEC1
008C EC00 F000 00301         CALL    _lcd_write
0090 2AE1      00302         INCF    FSR1L, F
0092 CFE4 F000 00303         MOVFF   PREINC1, r0x02
0096 CFE4 F000 00304         MOVFF   PREINC1, r0x01
009A CFE4 F000 00305         MOVFF   PREINC1, r0x00
009E CFE4 FFD9 00306         MOVFF   PREINC1, FSR2L
00A2 0012      00307         RETURN  
               00308 
               00309 ; ; Starting pCode block
               00310 S_glcd__lcd_read        code
0000 00311 _lcd_read:
               00312 ;       .line   187; glcd.c     unsigned char lcd_read (void) {
0000 CFD9 FFE5 00313         MOVFF   FSR2L, POSTDEC1
0004 CFE1 FFD9 00314         MOVFF   FSR1L, FSR2L
0008 C000 FFE5 00315         MOVFF   r0x00, POSTDEC1
               00316 ;       .line   190; glcd.c     LCD_TRIS = 0xFF;
000C 0EFF      00317         MOVLW   0xff
000E 6E00      00318         MOVWF   _TRISD
               00319 ;       .line   191; glcd.c     RW = 1; // read
0010 8200      00320         BSF     _PORTEbits, 1
               00321 ;       .line   192; glcd.c     DI = 1; // data
0012 8000      00322         BSF     _PORTEbits, 0
               00323 ;       .line   194; glcd.c     lcd_enable();
0014 EC00 F000 00324         CALL    _lcd_enable
gpasm-0.13.7 beta               glcd.asm    12-18-2012  04:56:14         PAGE  7


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE
 
               00325 ;       .line   195; glcd.c     d = LCD_DATA;
0018 C000 F000 00326         MOVFF   _PORTD, r0x00
               00327 ;       .line   196; glcd.c     LCD_TRIS = 0x00;
001C 6A00      00328         CLRF    _TRISD
               00329 ;       .line   198; glcd.c     return d;
001E 5000      00330         MOVF    r0x00, W
0020 CFE4 F000 00331         MOVFF   PREINC1, r0x00
0024 CFE4 FFD9 00332         MOVFF   PREINC1, FSR2L
0028 0012      00333         RETURN  
               00334 
               00335 ; ; Starting pCode block
               00336 S_glcd__lcd_selectside  code
0000 00337 _lcd_selectside:
               00338 ;       .line   166; glcd.c     void lcd_selectside(unsigned char sides) {
0000 CFD9 FFE5 00339         MOVFF   FSR2L, POSTDEC1
0004 CFE1 FFD9 00340         MOVFF   FSR1L, FSR2L
0008 C000 FFE5 00341         MOVFF   r0x00, POSTDEC1
000C 0E02      00342         MOVLW   0x02
000E CFDB F000 00343         MOVFF   PLUSW2, r0x00
               00344 ;       .line   169; glcd.c     if (sides & LCD_LEFT) {
0012 A000      00345         BTFSS   r0x00, 0
0014 D000      00346         BRA     _00184_DS_
               00347 ;       .line   170; glcd.c     CS1 = 0;
0016 9000      00348         BCF     _PORTCbits, 0
0018 D000      00349         BRA     _00185_DS_
001A 00350 _00184_DS_:
               00351 ;       .line   173; glcd.c     CS1 = 1;
001A 8000      00352         BSF     _PORTCbits, 0
001C 00353 _00185_DS_:
               00354 ;       .line   176; glcd.c     if (sides & LCD_RIGHT) {
001C A200      00355         BTFSS   r0x00, 1
001E D000      00356         BRA     _00187_DS_
               00357 ;       .line   177; glcd.c     CS2 = 0;
0020 9200      00358         BCF     _PORTCbits, 1
0022 D000      00359         BRA     _00189_DS_
0024 00360 _00187_DS_:
               00361 ;       .line   180; glcd.c     CS2 = 1;
0024 8200      00362         BSF     _PORTCbits, 1
0026 00363 _00189_DS_:
0026 CFE4 F000 00364         MOVFF   PREINC1, r0x00
002A CFE4 FFD9 00365         MOVFF   PREINC1, FSR2L
002E 0012      00366         RETURN  
               00367 
               00368 ; ; Starting pCode block
               00369 S_glcd__lcd_write       code
0000 00370 _lcd_write:
               00371 ;       .line   156; glcd.c     void lcd_write (unsigned char d) {
0000 CFD9 FFE5 00372         MOVFF   FSR2L, POSTDEC1
0004 CFE1 FFD9 00373         MOVFF   FSR1L, FSR2L
0008 C000 FFE5 00374         MOVFF   r0x00, POSTDEC1
000C 0E02      00375         MOVLW   0x02
000E CFDB F000 00376         MOVFF   PLUSW2, r0x00
               00377 ;       .line   157; glcd.c     lcd_waitbusy();
0012 EC00 F000 00378         CALL    _lcd_waitbusy
gpasm-0.13.7 beta               glcd.asm    12-18-2012  04:56:14         PAGE  8


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE
 
               00379 ;       .line   158; glcd.c     DI = 1; // data
0016 8000      00380         BSF     _PORTEbits, 0
               00381 ;       .line   159; glcd.c     RW = 0; // write
0018 9200      00382         BCF     _PORTEbits, 1
               00383 ;       .line   160; glcd.c     LCD_TRIS = 0; 
001A 6A00      00384         CLRF    _TRISD
               00385 ;       .line   161; glcd.c     LCD_DATA = d;
001C C000 F000 00386         MOVFF   r0x00, _PORTD
               00387 ;       .line   162; glcd.c     lcd_enable();
0020 EC00 F000 00388         CALL    _lcd_enable
0024 CFE4 F000 00389         MOVFF   PREINC1, r0x00
0028 CFE4 FFD9 00390         MOVFF   PREINC1, FSR2L
002C 0012      00391         RETURN  
               00392 
               00393 ; ; Starting pCode block
               00394 S_glcd__lcd_waitbusy    code
0000 00395 _lcd_waitbusy:
               00396 ;       .line   149; glcd.c     void lcd_waitbusy(void) {
0000 CFD9 FFE5 00397         MOVFF   FSR2L, POSTDEC1
0004 CFE1 FFD9 00398         MOVFF   FSR1L, FSR2L
0008 C000 FFE5 00399         MOVFF   r0x00, POSTDEC1
000C 00400 _00166_DS_:
               00401 ;       .line   150; glcd.c     while (lcd_status() & 0b10000000) {
000C EC00 F000 00402         CALL    _lcd_status
0010 6E00      00403         MOVWF   r0x00
0012 AE00      00404         BTFSS   r0x00, 7
0014 D000      00405         BRA     _00169_DS_
0016 00406 _00173_DS_:
0016 0000      00407         nop 
0018 0000      00408         nop 
001A D000      00409         BRA     _00166_DS_
001C 00410 _00169_DS_:
001C CFE4 F000 00411         MOVFF   PREINC1, r0x00
0020 CFE4 FFD9 00412         MOVFF   PREINC1, FSR2L
0024 0012      00413         RETURN  
               00414 
               00415 ; ; Starting pCode block
               00416 S_glcd__lcd_setyaddr    code
0000 00417 _lcd_setyaddr:
               00418 ;       .line   138; glcd.c     void lcd_setyaddr(unsigned char y) {
0000 CFD9 FFE5 00419         MOVFF   FSR2L, POSTDEC1
0004 CFE1 FFD9 00420         MOVFF   FSR1L, FSR2L
0008 C000 FFE5 00421         MOVFF   r0x00, POSTDEC1
000C 0E02      00422         MOVLW   0x02
000E CFDB F000 00423         MOVFF   PLUSW2, r0x00
               00424 ;       .line   140; glcd.c     lcd_waitbusy();
0012 EC00 F000 00425         CALL    _lcd_waitbusy
               00426 ;       .line   141; glcd.c     DI = 0; RW = 0;
0016 9000      00427         BCF     _PORTEbits, 0
0018 9200      00428         BCF     _PORTEbits, 1
               00429 ;       .line   142; glcd.c     LCD_DATA = 0b01000000 | (y & 0b00111111);
001A 0E3F      00430         MOVLW   0x3f
001C 1600      00431         ANDWF   r0x00, F
001E 0E40      00432         MOVLW   0x40
gpasm-0.13.7 beta               glcd.asm    12-18-2012  04:56:14         PAGE  9


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE
 
0020 1000      00433         IORWF   r0x00, W
0022 6E00      00434         MOVWF   _PORTD
               00435 ;       .line   143; glcd.c     lcd_enable();
0024 EC00 F000 00436         CALL    _lcd_enable
0028 CFE4 F000 00437         MOVFF   PREINC1, r0x00
002C CFE4 FFD9 00438         MOVFF   PREINC1, FSR2L
0030 0012      00439         RETURN  
               00440 
               00441 ; ; Starting pCode block
               00442 S_glcd__lcd_setpage     code
0000 00443 _lcd_setpage:
               00444 ;       .line   126; glcd.c     void lcd_setpage(unsigned char page) {
0000 CFD9 FFE5 00445         MOVFF   FSR2L, POSTDEC1
0004 CFE1 FFD9 00446         MOVFF   FSR1L, FSR2L
0008 C000 FFE5 00447         MOVFF   r0x00, POSTDEC1
000C 0E02      00448         MOVLW   0x02
000E CFDB F000 00449         MOVFF   PLUSW2, r0x00
               00450 ;       .line   128; glcd.c     lcd_waitbusy();
0012 EC00 F000 00451         CALL    _lcd_waitbusy
               00452 ;       .line   129; glcd.c     DI = 0; RW = 0; 
0016 9000      00453         BCF     _PORTEbits, 0
0018 9200      00454         BCF     _PORTEbits, 1
               00455 ;       .line   130; glcd.c     LCD_DATA = 0b10111000 | page;
001A 0EB8      00456         MOVLW   0xb8
001C 1000      00457         IORWF   r0x00, W
001E 6E00      00458         MOVWF   _PORTD
               00459 ;       .line   131; glcd.c     lcd_enable();
0020 EC00 F000 00460         CALL    _lcd_enable
0024 CFE4 F000 00461         MOVFF   PREINC1, r0x00
0028 CFE4 FFD9 00462         MOVFF   PREINC1, FSR2L
002C 0012      00463         RETURN  
               00464 
               00465 ; ; Starting pCode block
               00466 S_glcd__lcd_cls code
0000 00467 _lcd_cls:
               00468 ;       .line   98; glcd.c      void lcd_cls(void) {
0000 CFD9 FFE5 00469         MOVFF   FSR2L, POSTDEC1
0004 CFE1 FFD9 00470         MOVFF   FSR1L, FSR2L
0008 C000 FFE5 00471         MOVFF   r0x00, POSTDEC1
000C C000 FFE5 00472         MOVFF   r0x01, POSTDEC1
               00473 ;       .line   102; glcd.c     lcd_selectside(LCD_BOTH);
0010 0E03      00474         MOVLW   0x03
0012 6EE5      00475         MOVWF   POSTDEC1
0014 EC00 F000 00476         CALL    _lcd_selectside
0018 2AE1      00477         INCF    FSR1L, F
               00478 ;       .line   103; glcd.c     for (x = 0; x < 8; x++) {
001A 6A00      00479         CLRF    r0x00
001C 00480 _00140_DS_:
001C 0E08      00481         MOVLW   0x08
001E 5C00      00482         SUBWF   r0x00, W
0020 E200      00483         BC      _00143_DS_
               00484 ;       .line   105; glcd.c     lcd_setpage(x);
0022 5000      00485         MOVF    r0x00, W
0024 6EE5      00486         MOVWF   POSTDEC1
gpasm-0.13.7 beta               glcd.asm    12-18-2012  04:56:14         PAGE 10


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE
 
0026 EC00 F000 00487         CALL    _lcd_setpage
002A 2AE1      00488         INCF    FSR1L, F
               00489 ;       .line   108; glcd.c     lcd_setyaddr(0);
002C 0E00      00490         MOVLW   0x00
002E 6EE5      00491         MOVWF   POSTDEC1
0030 EC00 F000 00492         CALL    _lcd_setyaddr
0034 2AE1      00493         INCF    FSR1L, F
               00494 ;       .line   111; glcd.c     LCD_DATA = 0; RW = 0; DI = 1;
0036 6A00      00495         CLRF    _PORTD
0038 9200      00496         BCF     _PORTEbits, 1
003A 8000      00497         BSF     _PORTEbits, 0
               00498 ;       .line   114; glcd.c     for (y = 0; y < 64; y++) {
003C 0E40      00499         MOVLW   0x40
003E 6E00      00500         MOVWF   r0x01
0040 00501 _00139_DS_:
               00502 ;       .line   115; glcd.c     lcd_enable(); 
0040 EC00 F000 00503         CALL    _lcd_enable
0044 0000      00504         nop 
0046 0000      00505         nop 
0048 2E00      00506         DECFSZ  r0x01, F
004A D000      00507         BRA     _00139_DS_
               00508 ;       .line   103; glcd.c     for (x = 0; x < 8; x++) {
004C 2A00      00509         INCF    r0x00, F
004E D000      00510         BRA     _00140_DS_
0050 00511 _00143_DS_:
               00512 ;       .line   121; glcd.c     lcd_selectside(LCD_LEFT);
0050 0E01      00513         MOVLW   0x01
0052 6EE5      00514         MOVWF   POSTDEC1
0054 EC00 F000 00515         CALL    _lcd_selectside
0058 2AE1      00516         INCF    FSR1L, F
005A CFE4 F000 00517         MOVFF   PREINC1, r0x01
005E CFE4 F000 00518         MOVFF   PREINC1, r0x00
0062 CFE4 FFD9 00519         MOVFF   PREINC1, FSR2L
0066 0012      00520         RETURN  
               00521 
               00522 ; ; Starting pCode block
               00523 S_glcd__lcd_screenon    code
0000 00524 _lcd_screenon:
               00525 ;       .line   86; glcd.c      void lcd_screenon(unsigned char on) {
0000 CFD9 FFE5 00526         MOVFF   FSR2L, POSTDEC1
0004 CFE1 FFD9 00527         MOVFF   FSR1L, FSR2L
0008 C000 FFE5 00528         MOVFF   r0x00, POSTDEC1
000C 0E02      00529         MOVLW   0x02
000E CFDB F000 00530         MOVFF   PLUSW2, r0x00
               00531 ;       .line   88; glcd.c      CS1 = 0;
0012 9000      00532         BCF     _PORTCbits, 0
               00533 ;       .line   89; glcd.c      CS2 = 0;
0014 9200      00534         BCF     _PORTCbits, 1
               00535 ;       .line   90; glcd.c      RW = 0;
0016 9200      00536         BCF     _PORTEbits, 1
               00537 ;       .line   91; glcd.c      DI = 0;
0018 9000      00538         BCF     _PORTEbits, 0
               00539 ;       .line   92; glcd.c      LCD_TRIS = 0;   // all outputs  
001A 6A00      00540         CLRF    _TRISD
gpasm-0.13.7 beta               glcd.asm    12-18-2012  04:56:14         PAGE 11


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE
 
               00541 ;       .line   93; glcd.c      LATD = 0b00111110 | (on & 0b00000001);  // main screen turn on!
001C 0E01      00542         MOVLW   0x01
001E 1600      00543         ANDWF   r0x00, F
0020 0E3E      00544         MOVLW   0x3e
0022 1000      00545         IORWF   r0x00, W
0024 6E00      00546         MOVWF   _LATD
               00547 ;       .line   94; glcd.c      lcd_enable();
0026 EC00 F000 00548         CALL    _lcd_enable
002A CFE4 F000 00549         MOVFF   PREINC1, r0x00
002E CFE4 FFD9 00550         MOVFF   PREINC1, FSR2L
0032 0012      00551         RETURN  
               00552 
               00553 ; ; Starting pCode block
               00554 S_glcd__lcd_reset       code
0000 00555 _lcd_reset:
               00556 ;       .line   67; glcd.c      void lcd_reset(void) {
0000 CFD9 FFE5 00557         MOVFF   FSR2L, POSTDEC1
0004 CFE1 FFD9 00558         MOVFF   FSR1L, FSR2L
0008 C000 FFE5 00559         MOVFF   r0x00, POSTDEC1
               00560 ;       .line   74; glcd.c      sleep_ms(1);
000C 0E00      00561         MOVLW   0x00
000E 6EE5      00562         MOVWF   POSTDEC1
0010 0E00      00563         MOVLW   0x00
0012 6EE5      00564         MOVWF   POSTDEC1
0014 0E00      00565         MOVLW   0x00
0016 6EE5      00566         MOVWF   POSTDEC1
0018 0E01      00567         MOVLW   0x01
001A 6EE5      00568         MOVWF   POSTDEC1
001C EC00 F000 00569         CALL    _sleep_ms
0020 0E04      00570         MOVLW   0x04
0022 26E1      00571         ADDWF   FSR1L, F
               00572 ;       .line   75; glcd.c      RESET = 1;
0024 8A00      00573         BSF     _PORTCbits, 5
               00574 ;       .line   76; glcd.c      sleep_ms(1);
0026 0E00      00575         MOVLW   0x00
0028 6EE5      00576         MOVWF   POSTDEC1
002A 0E00      00577         MOVLW   0x00
002C 6EE5      00578         MOVWF   POSTDEC1
002E 0E00      00579         MOVLW   0x00
0030 6EE5      00580         MOVWF   POSTDEC1
0032 0E01      00581         MOVLW   0x01
0034 6EE5      00582         MOVWF   POSTDEC1
0036 EC00 F000 00583         CALL    _sleep_ms
003A 0E04      00584         MOVLW   0x04
003C 26E1      00585         ADDWF   FSR1L, F
               00586 ;       .line   77; glcd.c      RESET = 0;
003E 9A00      00587         BCF     _PORTCbits, 5
0040 00588 _00120_DS_:
               00589 ;       .line   80; glcd.c      while (lcd_status() & 0b00010000) {
0040 EC00 F000 00590         CALL    _lcd_status
0044 6E00      00591         MOVWF   r0x00
0046 A800      00592         BTFSS   r0x00, 4
0048 D000      00593         BRA     _00123_DS_
               00594 ;       .line   81; glcd.c      sleep_ms(1);
gpasm-0.13.7 beta               glcd.asm    12-18-2012  04:56:14         PAGE 12


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE
 
004A 0E00      00595         MOVLW   0x00
004C 6EE5      00596         MOVWF   POSTDEC1
004E 0E00      00597         MOVLW   0x00
0050 6EE5      00598         MOVWF   POSTDEC1
0052 0E00      00599         MOVLW   0x00
0054 6EE5      00600         MOVWF   POSTDEC1
0056 0E01      00601         MOVLW   0x01
0058 6EE5      00602         MOVWF   POSTDEC1
005A EC00 F000 00603         CALL    _sleep_ms
005E 0E04      00604         MOVLW   0x04
0060 26E1      00605         ADDWF   FSR1L, F
0062 D000      00606         BRA     _00120_DS_
0064 00607 _00123_DS_:
0064 CFE4 F000 00608         MOVFF   PREINC1, r0x00
0068 CFE4 FFD9 00609         MOVFF   PREINC1, FSR2L
006C 0012      00610         RETURN  
               00611 
               00612 ; ; Starting pCode block
               00613 S_glcd__lcd_status      code
0000 00614 _lcd_status:
               00615 ;       .line   44; glcd.c      unsigned char lcd_status(void) {
0000 CFD9 FFE5 00616         MOVFF   FSR2L, POSTDEC1
0004 CFE1 FFD9 00617         MOVFF   FSR1L, FSR2L
0008 C000 FFE5 00618         MOVFF   r0x00, POSTDEC1
000C C000 FFE5 00619         MOVFF   r0x01, POSTDEC1
               00620 ;       .line   51; glcd.c      _lcd_tris = LCD_TRIS;
0010 C000 F000 00621         MOVFF   _TRISD, r0x00
               00622 ;       .line   54; glcd.c      LCD_TRIS = 0xFF;        // all inputs
0014 0EFF      00623         MOVLW   0xff
0016 6E00      00624         MOVWF   _TRISD
               00625 ;       .line   55; glcd.c      DI = 0; RW = 1;         // command/read
0018 9000      00626         BCF     _PORTEbits, 0
001A 8200      00627         BSF     _PORTEbits, 1
               00628 ;       .line   57; glcd.c      lcd_enable();
001C EC00 F000 00629         CALL    _lcd_enable
               00630 ;       .line   58; glcd.c      _status = LCD_DATA;
0020 C000 F000 00631         MOVFF   _PORTD, r0x01
               00632 ;       .line   61; glcd.c      LCD_TRIS = _lcd_tris;
0024 C000 F000 00633         MOVFF   r0x00, _TRISD
               00634 ;       .line   63; glcd.c      return _status;
0028 5000      00635         MOVF    r0x01, W
002A CFE4 F000 00636         MOVFF   PREINC1, r0x01
002E CFE4 F000 00637         MOVFF   PREINC1, r0x00
0032 CFE4 FFD9 00638         MOVFF   PREINC1, FSR2L
0036 0012      00639         RETURN  
               00640 
               00641 ; ; Starting pCode block
               00642 S_glcd__lcd_enable      code
0000 00643 _lcd_enable:
               00644 ;       .line   36; glcd.c      void lcd_enable(void) {
0000 CFD9 FFE5 00645         MOVFF   FSR2L, POSTDEC1
0004 CFE1 FFD9 00646         MOVFF   FSR1L, FSR2L
               00647 ;       .line   37; glcd.c      ENABLE = 1;
0008 8400      00648         BSF     _PORTEbits, 2
gpasm-0.13.7 beta               glcd.asm    12-18-2012  04:56:14         PAGE 13


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE
 
000A 0000      00649         nop 
000C 0000      00650         nop 
               00651 ;       .line   39; glcd.c      ENABLE = 0;
000E 9400      00652         BCF     _PORTEbits, 2
0010 0000      00653         nop 
0012 0000      00654         nop 
0014 CFE4 FFD9 00655         MOVFF   PREINC1, FSR2L
0018 0012      00656         RETURN  
               00657 
               00658 ; ; Starting pCode block
               00659 S_glcd__lcd_init        code
0000 00660 _lcd_init:
               00661 ;       .line   15; glcd.c      void lcd_init(void) {
0000 CFD9 FFE5 00662         MOVFF   FSR2L, POSTDEC1
0004 CFE1 FFD9 00663         MOVFF   FSR1L, FSR2L
               00664 ;       .line   16; glcd.c      LCD_TRIS = 0x00;
0008 6A00      00665         CLRF    _TRISD
               00666 ;       .line   17; glcd.c      ENABLE_TRIS = 0;
000A 9400      00667         BCF     _TRISEbits, 2
               00668 ;       .line   18; glcd.c      RW_TRIS = 0;
000C 9200      00669         BCF     _TRISEbits, 1
               00670 ;       .line   19; glcd.c      DI_TRIS = 0;
000E 9000      00671         BCF     _TRISEbits, 0
               00672 ;       .line   20; glcd.c      RESET_TRIS = 0;
0010 9A00      00673         BCF     _TRISCbits, 5
               00674 ;       .line   21; glcd.c      CS1_TRIS = 0;
0012 9000      00675         BCF     _TRISCbits, 0
               00676 ;       .line   22; glcd.c      CS2_TRIS = 0;
0014 9200      00677         BCF     _TRISCbits, 1
               00678 ;       .line   24; glcd.c      CS1 = 1;
0016 8000      00679         BSF     _PORTCbits, 0
               00680 ;       .line   25; glcd.c      CS2 = 1;
0018 8200      00681         BSF     _PORTCbits, 1
               00682 ;       .line   31; glcd.c      lcd_reset();
001A EC00 F000 00683         CALL    _lcd_reset
               00684 ;       .line   32; glcd.c      lcd_screenon(1);
001E 0E01      00685         MOVLW   0x01
0020 6EE5      00686         MOVWF   POSTDEC1
0022 EC00 F000 00687         CALL    _lcd_screenon
0026 2AE1      00688         INCF    FSR1L, F
               00689 ;       .line   33; glcd.c      lcd_cls();
0028 EC00 F000 00690         CALL    _lcd_cls
002C CFE4 FFD9 00691         MOVFF   PREINC1, FSR2L
0030 0012      00692         RETURN  
               00693 
               00694 
               00695 
               00696 ; Statistics:
               00697 ; code size:      832 (0x0340) bytes ( 0.63%)
               00698 ;                 416 (0x01a0) words
               00699 ; udata size:       1 (0x0001) bytes ( 0.03%)
               00700 ; access size:      3 (0x0003) bytes
               00701 
               00702 
gpasm-0.13.7 beta               glcd.asm    12-18-2012  04:56:14         PAGE 14


SYMBOL TABLE
  LABEL                             VALUE 

FSR1L                             00000FE1
FSR2L                             00000FD9
PLUSW2                            00000FDB
POSTDEC1                          00000FE5
PREINC1                           00000FE4
STATUS                            00000FD8
WREG                              00000FE8
_00120_DS_                        00000040
_00123_DS_                        00000064
_00139_DS_                        00000040
_00140_DS_                        0000001C
_00143_DS_                        00000050
_00166_DS_                        0000000C
_00169_DS_                        0000001C
_00173_DS_                        00000016
_00184_DS_                        0000001A
_00185_DS_                        0000001C
_00187_DS_                        00000024
_00189_DS_                        00000026
_00205_DS_                        00000030
_00206_DS_                        0000003A
_00213_DS_                        00000084
_00214_DS_                        0000007E
_ADCON0                           00000000
_ADCON0bits                       00000000
_ADCON1                           00000000
_ADCON1bits                       00000000
_ADCON2                           00000000
_ADCON2bits                       00000000
_ADRESH                           00000000
_ADRESL                           00000000
_BAUDCON                          00000000
_BAUDCONbits                      00000000
_BSR                              00000000
_BSRbits                          00000000
_CCP1CON                          00000000
_CCP1CONbits                      00000000
_CCP2CON                          00000000
_CCP2CONbits                      00000000
_CCPR1H                           00000000
_CCPR1L                           00000000
_CCPR2H                           00000000
_CCPR2L                           00000000
_CMCON                            00000000
_CMCONbits                        00000000
_CVRCON                           00000000
_CVRCONbits                       00000000
_ECCP1AS                          00000000
_ECCP1ASbits                      00000000
_EEADR                            00000000
_EEADRH                           00000000
_EECON1                           00000000
_EECON1bits                       00000000
gpasm-0.13.7 beta               glcd.asm    12-18-2012  04:56:14         PAGE 15


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE
 
_EECON2                           00000000
_EEDATA                           00000000
_FSR0H                            00000000
_FSR0Hbits                        00000000
_FSR0L                            00000000
_FSR1H                            00000000
_FSR1Hbits                        00000000
_FSR1L                            00000000
_FSR2H                            00000000
_FSR2Hbits                        00000000
_FSR2L                            00000000
_HLVDCON                          00000000
_HLVDCONbits                      00000000
_INDF0                            00000000
_INDF1                            00000000
_INDF2                            00000000
_INTCON                           00000000
_INTCON2                          00000000
_INTCON2bits                      00000000
_INTCON3                          00000000
_INTCON3bits                      00000000
_INTCONbits                       00000000
_IPR1                             00000000
_IPR1bits                         00000000
_IPR2                             00000000
_IPR2bits                         00000000
_LATA                             00000000
_LATAbits                         00000000
_LATB                             00000000
_LATBbits                         00000000
_LATC                             00000000
_LATCbits                         00000000
_LATD                             00000000
_LATDbits                         00000000
_LATE                             00000000
_LATEbits                         00000000
_OSCCON                           00000000
_OSCCONbits                       00000000
_OSCTUNE                          00000000
_OSCTUNEbits                      00000000
_PCL                              00000000
_PCLATH                           00000000
_PCLATHbits                       00000000
_PCLATU                           00000000
_PCLATUbits                       00000000
_PIE1                             00000000
_PIE1bits                         00000000
_PIE2                             00000000
_PIE2bits                         00000000
_PIR1                             00000000
_PIR1bits                         00000000
_PIR2                             00000000
_PIR2bits                         00000000
_PLUSW0                           00000000
gpasm-0.13.7 beta               glcd.asm    12-18-2012  04:56:14         PAGE 16


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE
 
_PLUSW1                           00000000
_PLUSW2                           00000000
_PORTA                            00000000
_PORTAbits                        00000000
_PORTB                            00000000
_PORTBbits                        00000000
_PORTC                            00000000
_PORTCbits                        00000000
_PORTD                            00000000
_PORTDbits                        00000000
_PORTE                            00000000
_PORTEbits                        00000000
_POSTDEC0                         00000000
_POSTDEC1                         00000000
_POSTDEC2                         00000000
_POSTINC0                         00000000
_POSTINC1                         00000000
_POSTINC2                         00000000
_PR2                              00000000
_PREINC0                          00000000
_PREINC1                          00000000
_PREINC2                          00000000
_PRODH                            00000000
_PRODL                            00000000
_PWM1CON                          00000000
_PWM1CONbits                      00000000
_RCON                             00000000
_RCONbits                         00000000
_RCREG                            00000000
_RCSTA                            00000000
_RCSTAbits                        00000000
_SPBRG                            00000000
_SPBRGH                           00000000
_SSPADD                           00000000
_SSPBUF                           00000000
_SSPCON1                          00000000
_SSPCON1bits                      00000000
_SSPCON2                          00000000
_SSPCON2bits                      00000000
_SSPSTAT                          00000000
_SSPSTATbits                      00000000
_STATUS                           00000000
_STATUSbits                       00000000
_STKPTR                           00000000
_STKPTRbits                       00000000
_T0CON                            00000000
_T0CONbits                        00000000
_T1CON                            00000000
_T1CONbits                        00000000
_T2CON                            00000000
_T2CONbits                        00000000
_T3CON                            00000000
_T3CONbits                        00000000
_TABLAT                           00000000
gpasm-0.13.7 beta               glcd.asm    12-18-2012  04:56:14         PAGE 17


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE
 
_TBLPTRH                          00000000
_TBLPTRL                          00000000
_TBLPTRU                          00000000
_TBLPTRUbits                      00000000
_TMR0H                            00000000
_TMR0L                            00000000
_TMR1H                            00000000
_TMR1L                            00000000
_TMR2                             00000000
_TMR3H                            00000000
_TMR3L                            00000000
_TOSH                             00000000
_TOSL                             00000000
_TOSU                             00000000
_TOSUbits                         00000000
_TRISA                            00000000
_TRISAbits                        00000000
_TRISB                            00000000
_TRISBbits                        00000000
_TRISC                            00000000
_TRISCbits                        00000000
_TRISD                            00000000
_TRISDbits                        00000000
_TRISE                            00000000
_TRISEbits                        00000000
_TXREG                            00000000
_TXSTA                            00000000
_TXSTAbits                        00000000
_WDTCON                           00000000
_WDTCONbits                       00000000
_WREG                             00000000
__18F4620                         00000001
_lcd_buffer                       00000000
_lcd_cls                          00000000
_lcd_enable                       00000000
_lcd_init                         00000000
_lcd_plot_pixel                   00000000
_lcd_read                         00000000
_lcd_reset                        00000000
_lcd_screenon                     00000000
_lcd_selectside                   00000000
_lcd_setpage                      00000000
_lcd_setyaddr                     00000000
_lcd_status                       00000000
_lcd_waitbusy                     00000000
_lcd_write                        00000000
_sleep_ms                         00000000
r0x00                             00000000
r0x01                             00000001
r0x02                             00000002


Errors   :       0
Warnings :       0 reported,       0 suppressed
Messages :       0 reported,       0 suppressed

